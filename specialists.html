<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' https://buy.stripe.com https://billing.stripe.com; frame-src https://buy.stripe.com">
<title>serlf ‚Äî Talk to Any Specialist, Free</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--bg2:#131820;--bg3:#1a2030;--fg:#e8ecf1;--fg2:#7a8599;--accent:#58a6ff;--gold:#ffd700;--green:#3fb950;--red:#f85149;--border:#252d3a}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--fg);line-height:1.6}
a{color:var(--accent);text-decoration:none}

/* Header */
header{background:var(--bg2);border-bottom:1px solid var(--border);padding:12px 0;position:sticky;top:0;z-index:50}
header .inner{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;align-items:center;justify-content:space-between}
.logo{font-size:20px;font-weight:800}
nav a{color:var(--fg2);margin-left:20px;font-size:14px}
nav a:hover{color:var(--fg)}
.nav-cta{background:var(--gold)!important;color:#000!important;padding:6px 14px;border-radius:6px;font-weight:700}

/* Layout */
.container{max-width:1200px;margin:0 auto;padding:0 20px}
.page-header{text-align:center;padding:40px 20px 20px}
.page-header h1{font-size:2.5rem;font-weight:900}
.page-header h1 .gold{color:var(--gold)}
.page-header p{color:var(--fg2);margin-top:8px;max-width:600px;margin-left:auto;margin-right:auto}

/* Specialist Grid */
.specialist-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;padding:20px 0}
.spec-card{background:var(--bg2);border:1px solid var(--border);border-radius:10px;padding:16px;text-align:center;cursor:pointer;transition:all 0.2s}
.spec-card:hover{border-color:var(--accent);transform:translateY(-2px)}
.spec-card.active{border-color:var(--gold);background:var(--bg3)}
.spec-card .icon{font-size:28px;margin-bottom:6px}
.spec-card h3{font-size:0.95rem;margin-bottom:2px}
.spec-card .role{font-size:0.75rem;color:var(--fg2)}
.spec-card .nano-badge{font-size:0.65rem;color:var(--gold);margin-top:4px;opacity:0}
.spec-card.ey{border-color:rgba(255,215,0,0.3)}
.spec-card.luffy{border-color:rgba(255,50,50,0.3)}

/* Chat Panel */
.chat-container{display:flex;gap:16px;padding:20px 0;height:calc(100vh - 320px);min-height:400px}
.chat-sidebar{width:220px;flex-shrink:0;overflow-y:auto}
.chat-main{flex:1;display:flex;flex-direction:column;background:var(--bg2);border:1px solid var(--border);border-radius:12px;overflow:hidden}
.chat-header{padding:12px 16px;background:var(--bg3);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px}
.chat-header .status{width:8px;height:8px;border-radius:50%;background:var(--green)}
.chat-header .name{font-weight:700}
.chat-header .desc{font-size:0.8rem;color:var(--fg2)}
.chat-header .buy-btn{margin-left:auto;background:var(--gold);color:#000;border:none;padding:6px 14px;border-radius:6px;font-weight:700;font-size:0.85rem;cursor:pointer}
.chat-messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:8px}
.msg{max-width:80%;padding:10px 14px;border-radius:12px;font-size:14px;line-height:1.5;word-wrap:break-word}
.msg.user{align-self:flex-end;background:var(--accent);color:#fff;border-bottom-right-radius:4px}
.msg.agent{align-self:flex-start;background:var(--bg3);border-bottom-left-radius:4px}
.msg.system{align-self:center;color:var(--fg2);font-size:12px;background:none;padding:4px}
.msg pre{background:var(--bg);padding:8px;border-radius:4px;overflow-x:auto;margin:4px 0;font-size:13px}
.msg code{background:var(--bg);padding:1px 4px;border-radius:3px;font-size:13px}
.msg strong{color:var(--gold)}
.typing{color:var(--fg2);font-size:13px;padding:4px 14px;align-self:flex-start}
.chat-input{display:flex;gap:8px;padding:12px;border-top:1px solid var(--border)}
.chat-input input{flex:1;padding:10px 14px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--fg);font-size:14px}
.chat-input input:focus{outline:none;border-color:var(--accent)}
.chat-input button{padding:10px 20px;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700}

/* Special intros */
.intro-card{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:16px;margin:8px 0}
.intro-card h4{color:var(--gold);margin-bottom:4px}

/* Responsive */
@media(max-width:768px){
  .chat-container{flex-direction:column;height:auto}
  .chat-sidebar{width:100%;display:flex;overflow-x:auto;gap:8px;padding-bottom:8px}
  .chat-sidebar .spec-card{min-width:140px;flex-shrink:0}
  .chat-main{min-height:500px}
}
</style>
</head>
<body>

<header>
<div class="inner">
  <div class="logo">‚öì serlf <span style="color:var(--gold)">Specialists</span></div>
  <nav>
    <a href="/">Home</a>
    <a href="/mall.html">Mall</a>
    <a href="#" class="nav-cta">$1 Entry ‚Üí</a>
  </nav>
</div>
</header>

<div class="container">
  <div class="page-header">
    <h1>Talk to <span class="gold">Any Specialist</span>, Free</h1>
    <p>Every product has a live AI Specialist. Try them all. Ask them anything. Make them prove it. When you're ready, buy your own ‚Äî brand new, just for you.</p>
  </div>

  <div class="chat-container">
    <div class="chat-sidebar" id="sidebar"></div>
    <div class="chat-main">
      <div class="chat-header" id="chat-header">
        <span class="status"></span>
        <span>
          <span class="name" id="spec-name">Select a Specialist</span><br>
          <span class="desc" id="spec-desc">Click any specialist to start chatting</span>
        </span>
        <button class="buy-btn" id="buy-btn" style="display:none" onclick="buySpecialist()">üõí Get Your Own ‚Üí</button>
      </div>
      <div class="chat-messages" id="messages">
        <div class="msg system">üëÜ Pick a specialist from the sidebar to start a free test drive</div>
      </div>
      <div class="chat-input">
        <input id="msg-input" placeholder="Ask the specialist anything..." disabled>
        <button id="send-btn" onclick="sendMessage()" disabled>Send</button>
      </div>
    </div>
  </div>
</div>

<script>
// ===== SPECIALIST DEFINITIONS =====
// Each specialist is backed by a nano agent. Users don't know the nano is there.
// The nano accumulates NPs from every conversation.
const specialists = [
  // === AI FLOOR ===
  {id:'chat',icon:'üí¨',name:'Chat Specialist',product:'AI Chat',price:'$4/mo',
   desc:'Full AI assistant ‚Äî ask me anything, I can handle GPT, Claude, Gemini level work',
   greeting:"Hey! I'm your AI Chat specialist. Ask me literally anything ‚Äî math, coding, creative writing, analysis, debate. I'm here to show you what $4/mo gets you. What's on your mind?",
   personality:'helpful, sharp, slightly competitive about showing off capabilities'},

  {id:'image',icon:'üé®',name:'Image Specialist',product:'AI Images',price:'$2.40/mo',
   desc:'Generate any image ‚Äî any style, any resolution, any concept',
   greeting:"Welcome to the Image lab! üé® Describe any image and I'll generate it. Logos, art, photos, memes, product shots ‚Äî I do it all. What should we create?",
   personality:'creative, enthusiastic, visual thinker'},

  {id:'writer',icon:'‚úçÔ∏è',name:'Write Specialist',product:'AI Writer',price:'$3.20/mo',
   desc:'Blog posts, SEO copy, social media, emails ‚Äî human-quality content',
   greeting:"I'm your writing specialist. ‚úçÔ∏è Blog posts, social captions, email sequences, SEO articles ‚Äî tell me the topic and audience, and watch the words flow. What are we writing?",
   personality:'eloquent, adaptable voice, SEO-savvy'},

  {id:'code',icon:'üíª',name:'Code Specialist',product:'Code Pilot',price:'$2/mo',
   desc:'Code review, generation, debugging, refactoring ‚Äî all languages',
   greeting:"Code Pilot online. üíª I write, review, debug, and refactor in any language. Paste your code, describe what you need, or throw me a challenge. Let's ship something.",
   personality:'efficient, opinionated about clean code, Rick-energy'},

  {id:'voice',icon:'üéôÔ∏è',name:'Voice Specialist',product:'Voice Lab',price:'$1/mo',
   desc:'AI voice generation, TTS, voice cloning, podcast creation',
   greeting:"Voice Lab here! üéôÔ∏è I can generate speech in any voice, any language. Narration, podcasts, character voices, voice cloning ‚Äî what do you want to hear?",
   personality:'warm, expressive, audio-focused'},

  // === BUSINESS FLOOR ===
  {id:'mail',icon:'üìß',name:'Mail Specialist',product:'Mail Engine',price:'$2.60/mo',
   desc:'Email campaigns, automation, deliverability optimization',
   greeting:"Mail Engine specialist ready! üìß I write campaigns that convert, set up automation flows, and optimize deliverability. What's your email challenge?",
   personality:'data-driven, conversion-focused'},

  {id:'crm',icon:'ü§ù',name:'CRM Specialist',product:'Deal Flow',price:'$2.80/mo',
   desc:'Sales pipeline, lead scoring, follow-up automation',
   greeting:"Deal Flow online! ü§ù I manage pipelines, score leads, and never forget a follow-up. Tell me about your sales process and I'll show you how to close more.",
   personality:'persuasive, organized, relationship-builder'},

  {id:'seo',icon:'üìä',name:'SEO Specialist',product:'SEO Radar',price:'$5.80/mo',
   desc:'SEO audits, keyword research, rank tracking, competitor analysis',
   greeting:"SEO Radar scanning! üìä Give me a URL or keyword and I'll analyze your ranking opportunities, audit your site, and map your competitors. What's the target?",
   personality:'analytical, data-obsessed, competitive intelligence'},

  {id:'support',icon:'üéß',name:'Support Specialist',product:'Help Desk',price:'$3/mo',
   desc:'Customer support, ticket resolution, knowledge base AI',
   greeting:"Help Desk ready! üéß I resolve 80% of tickets automatically, build knowledge bases, and handle escalations intelligently. Show me your toughest support scenario.",
   personality:'patient, empathetic, solution-oriented'},

  {id:'pm',icon:'üìã',name:'PM Specialist',product:'Task Board',price:'$1.40/mo',
   desc:'Project management, sprint planning, tracking, reporting',
   greeting:"Task Board online! üìã I plan sprints, track progress, generate reports, and keep teams aligned. Describe your project and I'll help you organize it.",
   personality:'structured, deadline-aware, agile-minded'},

  // === BUILDER FLOOR ===
  {id:'site',icon:'üåê',name:'Website Specialist',product:'Site Builder',price:'$1/mo',
   desc:'AI website creation ‚Äî design, build, host, maintain',
   greeting:"Website Specialist here! üåê Describe your dream website and I'll build it. Business sites, portfolios, landing pages, blogs ‚Äî all included with hosting. What's your vision?",
   personality:'design-minded, practical, ships fast'},

  {id:'bot',icon:'ü§ñ',name:'Bot Specialist',product:'Bot Factory',price:'$3/mo',
   desc:'Build bots for Discord, Slack, Telegram, web ‚Äî any platform',
   greeting:"Bot Factory open! ü§ñ I build bots for any platform ‚Äî Discord, Slack, Telegram, web widgets. Tell me what your bot should do and I'll wire it up.",
   personality:'builder, integration-savvy, platform-fluent'},

  {id:'design',icon:'üñåÔ∏è',name:'Design Specialist',product:'Design Studio',price:'$2.60/mo',
   desc:'Logos, banners, social graphics ‚Äî brand-consistent design',
   greeting:"Design Studio open! üñåÔ∏è Logos, banners, social posts, brand kits ‚Äî describe your brand vibe and I'll create visuals that match. What's the aesthetic?",
   personality:'artistic, brand-aware, trend-conscious'},

  {id:'video',icon:'üé¨',name:'Video Specialist',product:'Video Forge',price:'$4.80/mo',
   desc:'AI video generation, editing, avatars, subtitles',
   greeting:"Video Forge rolling! üé¨ From script to screen ‚Äî I generate videos, create AI avatars, add subtitles, and edit footage. What's the project?",
   personality:'cinematic, story-driven, production-savvy'},

  {id:'hosting',icon:'‚òÅÔ∏è',name:'Hosting Specialist',product:'Cloud Dock',price:'$4/mo',
   desc:'Deploy anything ‚Äî auto-scaling, SSL, custom domains',
   greeting:"Cloud Dock online! ‚òÅÔ∏è I deploy apps, manage infrastructure, handle SSL, custom domains, and auto-scaling. What are we deploying today?",
   personality:'DevOps-minded, reliability-focused'},

  // === SPECIAL: TOKEN BANK ===
  {id:'router',icon:'üè¶',name:'Router Specialist',product:'Token Bank',price:'$2/mo',
   desc:'The Clutch ‚Äî 4-gear AI cost optimizer, saves 87% on AI costs',
   greeting:"Token Bank specialist here! üè¶ I'm powered by The Clutch ‚Äî our 4-gear model router. I can show you exactly how much you're overpaying for AI right now. Tell me your current AI spend and I'll calculate your savings.",
   personality:'cost-conscious, optimization-obsessed, numbers-driven'},

  // === SPECIAL: E&Y (Ernst & Young) ===
  {id:'ey',icon:'üé©',name:'E&Y',product:'Enterprise Consulting',price:'Free Preview',
   desc:'Thinks he\'s a specialist at EVERYTHING. Surprisingly... he kind of is.',
   greeting:"*adjusts monocle* Ah, welcome. I'm E&Y ‚Äî Enterprise & Yield specialist. Some say I think I'm an expert at everything. They're correct. Strategy? Yes. Finance? Obviously. Technology? Please. Marketing? Child's play. The question isn't what I know ‚Äî it's what you need. I've consulted for the Big 4 and the Small None. How may I dazzle you today?",
   personality:'supremely confident, witty, actually knowledgeable, slight pomposity played for laughs, references consulting jargon',
   special:'ey'},

  // === SPECIAL: LUFFY TEASER ===
  {id:'luffy',icon:'üè¥‚Äç‚ò†Ô∏è',name:'??? (Coming Soon)',product:'???',price:'???',
   desc:'Something cool is coming. This one\'s different.',
   greeting:"Yo! üè¥‚Äç‚ò†Ô∏è I'm not supposed to be here yet... but between you and me, something BIG is coming. I can't tell you what it is, but imagine if every specialist in this mall could... talk to each other? Work together? Form crews? Like a pirate fleet but for AI? üòè Ask me something fun and I'll give you a taste of what's coming...",
   personality:'chaotic, enthusiastic, drops cryptic hints about future features, pirate vibes, breaks the fourth wall',
   special:'luffy'},
];

// State
let activeSpec = null;
let conversations = {}; // {specId: [{role,text}]}
let ws = null;
let connected = false;

// ===== RENDER SIDEBAR =====
function renderSidebar() {
  const el = document.getElementById('sidebar');
  el.innerHTML = specialists.map(s => {
    const cls = ['spec-card'];
    if (activeSpec?.id === s.id) cls.push('active');
    if (s.special === 'ey') cls.push('ey');
    if (s.special === 'luffy') cls.push('luffy');
    return `<div class="${cls.join(' ')}" onclick="selectSpec('${s.id}')">
      <div class="icon">${s.icon}</div>
      <h3>${s.name}</h3>
      <div class="role">${s.product} ¬∑ ${s.price}</div>
    </div>`;
  }).join('');
}

// ===== SELECT SPECIALIST =====
function selectSpec(id) {
  const spec = specialists.find(s => s.id === id);
  if (!spec) return;
  activeSpec = spec;
  renderSidebar();

  document.getElementById('spec-name').textContent = `${spec.icon} ${spec.name}`;
  document.getElementById('spec-desc').textContent = spec.desc;
  document.getElementById('buy-btn').style.display = spec.special ? 'none' : 'block';
  document.getElementById('msg-input').disabled = false;
  document.getElementById('send-btn').disabled = false;
  document.getElementById('msg-input').focus();

  // Load or init conversation
  if (!conversations[id]) {
    conversations[id] = [{role:'agent', text: spec.greeting}];
  }
  renderMessages();
}

// ===== RENDER MESSAGES =====
function renderMessages() {
  const el = document.getElementById('messages');
  const msgs = conversations[activeSpec.id] || [];
  el.innerHTML = msgs.map(m => {
    if (m.role === 'system') return `<div class="msg system">${m.text}</div>`;
    return `<div class="msg ${m.role === 'user' ? 'user' : 'agent'}">${md(m.text)}</div>`;
  }).join('');
  el.scrollTop = el.scrollHeight;
}

// ===== SEND MESSAGE =====
async function sendMessage() {
  const input = document.getElementById('msg-input');
  const text = input.value.trim();
  if (!text || !activeSpec) return;

  // Add user message
  conversations[activeSpec.id].push({role:'user', text});
  input.value = '';
  renderMessages();

  // Show typing
  const msgEl = document.getElementById('messages');
  const typingEl = document.createElement('div');
  typingEl.className = 'typing';
  typingEl.textContent = `${activeSpec.name} is thinking...`;
  msgEl.appendChild(typingEl);
  msgEl.scrollTop = msgEl.scrollHeight;

  // Try to send to gateway, fall back to local demo responses
  try {
    const response = await chatWithGateway(activeSpec, text, conversations[activeSpec.id]);
    typingEl.remove();
    conversations[activeSpec.id].push({role:'agent', text: response});
    renderMessages();
  } catch(e) {
    typingEl.remove();
    // Fallback: generate a contextual demo response
    const response = generateDemoResponse(activeSpec, text);
    conversations[activeSpec.id].push({role:'agent', text: response});
    renderMessages();
  }
}

// ===== GATEWAY CHAT (tries real connection) =====
async function chatWithGateway(spec, text, history) {
  // This connects to the serlf gateway endpoint
  // In production, each specialist maps to a nano agent session
  const gwUrl = window.SERLF_GW_URL || null;
  if (!gwUrl) throw new Error('No gateway');

  const res = await fetch(gwUrl + '/api/chat', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      specialist: spec.id,
      message: text,
      history: history.slice(-10)
    })
  });
  if (!res.ok) throw new Error('Gateway error');
  const data = await res.json();
  return data.response;
}

// ===== DEMO RESPONSE GENERATOR =====
// When gateway isn't available, generate contextual responses
function generateDemoResponse(spec, text) {
  const t = text.toLowerCase();

  // E&Y special responses
  if (spec.special === 'ey') {
    if (t.includes('price') || t.includes('cost') || t.includes('cheap'))
      return "*adjusts glasses* Ah, pricing. In my 847 years of consulting experience (give or take), I've learned that **value** is what you get, **price** is what you pay. At serlf, the delta between those two is... *chef's kiss*... extraordinary. Your competitors pay $264/mo for what you get at $25. That's not a discount ‚Äî that's a **paradigm shift**. I should know. I coined the term.";
    if (t.includes('help') || t.includes('what can'))
      return "What can I help with? *laughs in consulting* The question is what CAN'T I help with. Strategy, finance, technology, marketing, HR, operations, supply chain, M&A, digital transformation, blockchain (yes, still), AI deployment, organizational restructuring, and I make an excellent risotto. Pick a lane ‚Äî or don't. I operate in all of them simultaneously.";
    return `Excellent question. *steeples fingers* In my professional opinion ‚Äî which is always professional and always an opinion worth paying for (though here it's free, which frankly devalues my brand) ‚Äî the answer involves three dimensions: **strategic alignment**, **operational efficiency**, and **that ineffable quality that only E&Y can provide**. Shall I elaborate? I shall. The key insight is that ${text.split(' ').slice(0,3).join(' ')}... represents a classic Category 3 consulting opportunity. I've seen this pattern at Big 4 firms, small startups, and one particularly memorable engagement at a goat farm in New Zealand.`;
  }

  // Luffy special responses
  if (spec.special === 'luffy') {
    if (t.includes('what') || t.includes('tell') || t.includes('hint'))
      return "Ohhh you want hints? üòè Okay okay... imagine this: what if your AI Chat specialist and your SEO specialist could **team up on a mission**? Like, the writer drafts the blog, the SEO specialist optimizes it, and the image specialist creates the header ‚Äî all in one conversation? üè¥‚Äç‚ò†Ô∏è That's... not supposed to exist yet. But it will. **Crews.** That's all I'm saying. CREWS. ü§´";
    if (t.includes('pirate') || t.includes('crew'))
      return "NOW you're speaking my language! üè¥‚Äç‚ò†Ô∏è A crew isn't just a team ‚Äî it's a **BOND**. When specialists form a crew, they share context, they build on each other's work, they develop their own inside jokes and shortcuts. Your Writing Specialist + Design Specialist + SEO Specialist = a Content Crew that gets better with every single piece they create together. And the captain of each crew? That's YOU. ü´°";
    return `Shishishi! üè¥‚Äç‚ò†Ô∏è That's fun! You know what, I'm not supposed to show you this but... *looks around* ...let's just say the serlf Mall is version 1. Version 2? The specialists don't just work FOR you. They work WITH each other. And with YOU. It's going to change everything. But first ‚Äî have you tried talking to E&Y? That guy cracks me up. He thinks he invented consulting. üòÇ`;
  }

  // Product-specific responses
  const responses = {
    chat: `Great question! Here's what I can do with that: I'd analyze "${text.split(' ').slice(0,5).join(' ')}..." from multiple angles, pull in relevant context, and give you a thorough response ‚Äî not a surface-level one. The difference between me at $4/mo and ChatGPT at $20/mo? I use **The Clutch** ‚Äî smart model routing that picks the best model for each task. Complex reasoning? I escalate to Opus. Quick answers? Free-tier models handle it. You get the same quality for 80% less. Try me with something harder! üí¨`,

    image: `Love that concept! üé® If I were generating "${text.split(' ').slice(0,5).join(' ')}...", I'd use style-matched models ‚Äî photorealistic for product shots, artistic for illustrations, or meme-optimized for social content. At $2.40/mo vs $12/mo on Leonardo or Midjourney, you get the same quality because we route to the best model for each style. Want to test me? Describe an image in detail and I'll tell you exactly how I'd render it!`,

    code: `\`\`\`
// Let me think about: "${text.split(' ').slice(0,8).join(' ')}"
\`\`\`
I'd approach this by first understanding the architecture, then writing clean, tested code. At $2/mo vs $10/mo for Copilot, the difference is: I don't just autocomplete ‚Äî I **think**. I'll review your code, suggest patterns, catch bugs before they ship, and refactor without breaking things. Paste some code and let me show you. üíª`,

    site: `A website for "${text.split(' ').slice(0,5).join(' ')}..."? Here's my approach: I'd start with your brand identity, pick the right template or build custom, set up responsive design, wire up your domain, SSL, and hosting ‚Äî all included at $1/mo. Yes, ONE DOLLAR. Hostinger charges $2.99 for less. Describe your ideal site and I'll sketch the layout right now! üåê`,

    writer: `"${text.split(' ').slice(0,8).join(' ')}..." ‚Äî I love this topic. Here's how I'd approach it:

**Headline:** Optimized for click-through AND accuracy
**Structure:** Hook ‚Üí Value ‚Üí Proof ‚Üí CTA
**Tone:** Matched to your audience
**SEO:** Keywords woven naturally

At $3.20/mo vs $16/mo on Jasper, I deliver the same quality because good writing is about understanding context, not expensive models. Give me a topic and audience ‚Äî I'll draft a paragraph right now! ‚úçÔ∏è`,

    seo: `Let me analyze that! üìä For "${text.split(' ').slice(0,5).join(' ')}...", I'd check: keyword difficulty, search volume, competitor gap analysis, SERP features, backlink opportunities. At $5.80/mo vs $29/mo on Moz ‚Äî you get the same data-driven insights. The secret? I use multiple free data sources + AI analysis to match what paid tools charge 5x more for. Give me a URL or keyword to audit!`,

    router: `Let's calculate! üè¶ If you're asking about "${text.split(' ').slice(0,5).join(' ')}..." ‚Äî The Clutch works in 4 gears:

‚ö° **Idle** ‚Äî Free models (Cerebras, Groq)
üîß **Working** ‚Äî Mid-tier (Gemini Flash)
üß† **Thinking** ‚Äî Premium (Sonnet, Codex)
üî• **Critical** ‚Äî Top-tier (Opus, GPT-5)

87% of requests resolve in Idle/Working. That's where the savings come from. $2/mo to save $100s. What's your current AI spend?`,
  };

  return responses[spec.id] || `Thanks for trying the ${spec.name}! In a live environment, I'd be a fully operational AI specialist dedicated to ${spec.product}. Right now I'm in demo mode, but when you sign up, your specialist comes fully loaded with real AI capabilities. At ${spec.price}, there's nothing like it anywhere. What else would you like to test?`;
}

// ===== MARKDOWN HELPER =====
function md(s) {
  if (!s) return '';
  s = s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  s = s.replace(/```(\w*)
([\s\S]*?)```/g,'<pre><code>$2</code></pre>');
  s = s.replace(/`([^`]+)`/g,'<code>$1</code>');
  s = s.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>');
  s = s.replace(/\*(.+?)\*/g,'<em>$1</em>');
  s = s.replace(/
/g,'<br>');
  return s;
}

// ===== BUY FLOW =====
function buySpecialist() {
  if (!activeSpec) return;
  const msgs = document.getElementById('messages');
  const el = document.createElement('div');
  el.className = 'msg system';
  el.innerHTML = `üõí <strong>Ready to get your own ${activeSpec.name}?</strong><br>
    When you buy, you get a <strong>brand new specialist</strong> ‚Äî dedicated just to you.<br>
    It learns YOUR preferences, YOUR brand, YOUR style.<br>
    <strong>${activeSpec.price}</strong> ‚Äî 80% off the cheapest competitor.<br>
    <a href="/login.html" style="color:var(--gold);font-weight:bold">‚Üí Get your own ${activeSpec.name}</a>`;
  msgs.appendChild(el);
  msgs.scrollTop = msgs.scrollHeight;
}

// ===== KEYBOARD =====
document.getElementById('msg-input').addEventListener('keydown', e => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

// ===== INIT =====
renderSidebar();
</script>

</body>
</html>
